# FaultMaven Self-Hosted Configuration
# Copy this file to .env and add your API keys

# ============================================================================
# LLM Provider - REQUIRED (configure at least one)
# ============================================================================
# Get API keys:
#   OpenAI: https://platform.openai.com/api-keys
#   Anthropic: https://console.anthropic.com/
#   Groq: https://console.groq.com/ (FREE tier - ultra-fast!)
#   Gemini: https://makersuite.google.com/app/apikey
#   Fireworks: https://fireworks.ai/api-keys
#   OpenRouter: https://openrouter.ai/keys

# Cloud LLM (recommended - best performance)
# OPENAI_API_KEY=sk-...
# ANTHROPIC_API_KEY=sk-ant-...
# GROQ_API_KEY=gsk_...
# GEMINI_API_KEY=...
# FIREWORKS_API_KEY=...
# OPENROUTER_API_KEY=...

# Local LLM (FREE, private - runs on your machine)
# Requires Ollama, LM Studio, LocalAI, or vLLM running locally
# LOCAL_LLM_API_KEY=not-needed
# LOCAL_LLM_URL=http://localhost:11434/v1
# LOCAL_LLM_MODEL=llama3.1

# Optional: Override default models
# Defaults if not specified:
#   OpenAI: gpt-4o-mini
#   Anthropic: claude-3-5-sonnet-20241022
#   Groq: llama-3.3-70b-versatile
#   Gemini: gemini-1.5-flash
#   Fireworks: accounts/fireworks/models/llama-v3p1-70b-instruct
#   OpenRouter: anthropic/claude-3.5-sonnet
#   Local LLM: (depends on your server configuration)
#
# Override examples:
# OPENAI_MODEL=gpt-4o
# ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
# GROQ_MODEL=llama-3.3-70b-versatile
# GEMINI_MODEL=gemini-1.5-pro
# FIREWORKS_MODEL=accounts/fireworks/models/llama-v3p3-70b-instruct
# OPENROUTER_MODEL=openai/gpt-4o-mini

# ============================================================================
# Deployment Profile (DO NOT CHANGE for self-hosted)
# ============================================================================
PROFILE=public

# ============================================================================
# Database Configuration (SQLite - zero config)
# ============================================================================
DB_TYPE=sqlite
DATABASE_URL=sqlite+aiosqlite:////data/faultmaven.db

# ============================================================================
# Infrastructure Services (configured by docker-compose)
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379

CHROMADB_HOST=chromadb
CHROMADB_PORT=8000

# ============================================================================
# API Gateway Configuration
# ============================================================================
# API Gateway is the single entry point for all client requests
# Browser extension and dashboard connect to this port
# External URL: http://SERVER_HOST:8090
API_GATEWAY_PORT=8090

# ============================================================================
# Service URLs (internal Docker network)
# ============================================================================
# Used by API Gateway for routing and by services for inter-service calls.
# All services run on internal port 8000, exposed externally on: Auth=8001, Session=8002, etc.
FM_AUTH_SERVICE_URL=http://fm-auth-service:8000
FM_SESSION_SERVICE_URL=http://fm-session-service:8000
FM_CASE_SERVICE_URL=http://fm-case-service:8000
FM_KNOWLEDGE_SERVICE_URL=http://fm-knowledge-service:8000
FM_EVIDENCE_SERVICE_URL=http://fm-evidence-service:8000
FM_AGENT_SERVICE_URL=http://fm-agent-service:8000

# ============================================================================
# Storage Configuration
# ============================================================================
STORAGE_TYPE=local
LOCAL_UPLOAD_DIR=/data/uploads

# ============================================================================
# Network Configuration - REQUIRED
# ============================================================================
# ⚠️ REQUIRED: Set your server's IP address or hostname
#
# This is used by the dashboard to connect to the API Gateway.
# - Use your server's IP for remote access (e.g., 192.168.0.200)
# - Use 'localhost' ONLY if dashboard will be accessed on the same machine
# - Use hostname if you have DNS (e.g., faultmaven.local)
#
# Examples:
#   SERVER_HOST=192.168.0.200    # Local network access
#   SERVER_HOST=faultmaven.local # Hostname
#   SERVER_HOST=localhost        # Same-machine only
#
# ❌ Common mistake: Leaving this empty will cause dashboard connection failures!
SERVER_HOST=                             # ⚠️ REQUIRED - FILL THIS IN!

# ============================================================================
# Authentication Configuration
# ============================================================================
# FaultMaven supports three authentication modes via AUTH_PROVIDER:
#   - local: Username/password with JWT (default for self-hosted)
#   - oidc: OpenID Connect SSO (Google, Azure AD, Okta)
#   - saml: SAML 2.0 SSO (enterprise identity providers)
#
# Self-hosted deployments use 'local' by default.
# Enterprise cloud deployments use 'oidc' or 'saml'.
# ============================================================================

# Authentication provider mode (local|oidc|saml)
AUTH_PROVIDER=local

# --- Local Authentication (username/password) ---
# Used when AUTH_PROVIDER=local (default for self-hosted)
#
# ⚠️ CRITICAL SECURITY WARNING ⚠️
# These default credentials are publicly known and MUST be changed!
#
# On first deployment:
#   1. Change DASHBOARD_PASSWORD to a strong, unique password
#   2. Consider changing DASHBOARD_USERNAME from 'admin'
#   3. Store credentials securely (password manager recommended)
#
# ❌ DO NOT use these defaults in production!
# ❌ DO NOT commit your actual credentials to version control!
#
DASHBOARD_USERNAME=admin                 # ⚠️ CHANGE THIS
DASHBOARD_PASSWORD=changeme123           # ⚠️ CHANGE THIS - Use strong password!

# JWT Configuration (local auth only)
# Generate a strong secret key: openssl rand -hex 32
SECRET_KEY=dev-secret-change-in-production  # ⚠️ CHANGE IN PRODUCTION
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=60
REFRESH_TOKEN_EXPIRE_DAYS=7

# --- OIDC Authentication (Google, Azure AD, Okta, etc.) ---
# Used when AUTH_PROVIDER=oidc
#
# Required fields:
#   OIDC_ISSUER_URL: OIDC provider issuer URL
#   OIDC_CLIENT_ID: OAuth 2.0 client ID
#   OIDC_CLIENT_SECRET: OAuth 2.0 client secret
#
# Examples:
#   Google Workspace:
#     OIDC_ISSUER_URL=https://accounts.google.com
#     OIDC_CLIENT_ID=123456789.apps.googleusercontent.com
#     OIDC_CLIENT_SECRET=GOCSPX-xxx
#     OIDC_SCOPES="openid email profile"
#
#   Microsoft Azure AD / Entra ID:
#     OIDC_ISSUER_URL=https://login.microsoftonline.com/{tenant-id}/v2.0
#     OIDC_CLIENT_ID=xxx
#     OIDC_CLIENT_SECRET=xxx
#     OIDC_SCOPES="openid email profile"
#
#   Okta:
#     OIDC_ISSUER_URL=https://{domain}.okta.com/oauth2/default
#     OIDC_CLIENT_ID=xxx
#     OIDC_CLIENT_SECRET=xxx
#     OIDC_SCOPES="openid email profile"
#
# OIDC_ISSUER_URL=
# OIDC_CLIENT_ID=
# OIDC_CLIENT_SECRET=
# OIDC_SCOPES="openid email profile"

# --- SAML Authentication (enterprise SSO) ---
# Used when AUTH_PROVIDER=saml
#
# Required fields:
#   SAML_IDP_METADATA_URL: SAML IdP metadata URL
#   SAML_SP_ENTITY_ID: Service Provider entity ID (default: faultmaven)
#   SAML_SP_ACS_URL: Assertion Consumer Service URL
#
# Example:
#   SAML_IDP_METADATA_URL=https://idp.example.com/metadata
#   SAML_SP_ENTITY_ID=faultmaven
#   SAML_SP_ACS_URL=https://api.faultmaven.ai/api/v1/auth/saml/acs
#
# SAML_IDP_METADATA_URL=
# SAML_SP_ENTITY_ID=faultmaven
# SAML_SP_ACS_URL=

# Optional: Default user token for headless browser extension access
# Generate with: openssl rand -hex 32
# DEFAULT_USER_TOKEN=
